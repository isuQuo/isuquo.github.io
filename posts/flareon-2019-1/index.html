<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Flare-on 2019 challenge #3 | My blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Welcome to my first Flare-on 2019 challenge write up. This challenge is called Memecat Battlestation.
The challenge comes with a readme that reads:

Welcome to the Sixth Flare-On Challenge!
This is a simple game. Reverse engineer it to figure out what &ldquo;weapon codes&rdquo; you need to enter to defeat each of the two enemies and the victory screen will reveal the flag. Enter the flag here on this site to score and move on to the next level."><meta name=generator content="Hugo 0.147.8"><meta name=robots content="index, follow"><link rel=stylesheet href=/ananke/css/main.min.8d048772ae72ab11245a0e296d1f2a36d3e3dd376c6c867394d6cc659c68fc37.css><link rel=canonical href=https://isuquo.github.io/posts/flareon-2019-1/><meta property="og:url" content="https://isuquo.github.io/posts/flareon-2019-1/"><meta property="og:site_name" content="My blog"><meta property="og:title" content="Flare-on 2019 challenge #3"><meta property="og:description" content="Welcome to my first Flare-on 2019 challenge write up. This challenge is called Memecat Battlestation.
The challenge comes with a readme that reads:
Welcome to the Sixth Flare-On Challenge! This is a simple game. Reverse engineer it to figure out what “weapon codes” you need to enter to defeat each of the two enemies and the victory screen will reveal the flag. Enter the flag here on this site to score and move on to the next level."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-10-06T00:00:00+00:00"><meta property="article:modified_time" content="2019-10-06T00:00:00+00:00"><meta itemprop=name content="Flare-on 2019 challenge #3"><meta itemprop=description content="Welcome to my first Flare-on 2019 challenge write up. This challenge is called Memecat Battlestation.
The challenge comes with a readme that reads:
Welcome to the Sixth Flare-On Challenge! This is a simple game. Reverse engineer it to figure out what “weapon codes” you need to enter to defeat each of the two enemies and the victory screen will reveal the flag. Enter the flag here on this site to score and move on to the next level."><meta itemprop=datePublished content="2019-10-06T00:00:00+00:00"><meta itemprop=dateModified content="2019-10-06T00:00:00+00:00"><meta itemprop=wordCount content="434"><meta name=twitter:card content="summary"><meta name=twitter:title content="Flare-on 2019 challenge #3"><meta name=twitter:description content="Welcome to my first Flare-on 2019 challenge write up. This challenge is called Memecat Battlestation.
The challenge comes with a readme that reads:
Welcome to the Sixth Flare-On Challenge! This is a simple game. Reverse engineer it to figure out what “weapon codes” you need to enter to defeat each of the two enemies and the victory screen will reveal the flag. Enter the flag here on this site to score and move on to the next level."></head><body class="ma0 avenir bg-near-white production"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l center items-center justify-between"><a href=/ class="f3 fw2 hover-white white-90 dib no-underline">My blog</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l mw8 center ph3 flex-wrap justify-between"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked ttu">Posts</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">Flare-on 2019 challenge #3</h1><time class="f6 mv4 dib tracked" datetime=2019-10-06T00:00:00Z>October 6, 2019</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>Welcome to my first Flare-on 2019 challenge write up. This challenge is called Memecat Battlestation.</p><p>The challenge comes with a readme that reads:</p><blockquote><p>Welcome to the Sixth Flare-On Challenge!
This is a simple game. Reverse engineer it to figure out what &ldquo;weapon codes&rdquo; you need to enter to defeat each of the two enemies and the victory screen will reveal the flag. Enter the flag here on this site to score and move on to the next level.</p><ul><li>This challenge is written in .NET. If you don&rsquo;t already have a favorite .NET reverse engineering tool I recommend dnSpy</li><li>If you already solved the full version of this game at our booth at BlackHat or the subsequent release on twitter, congratulations, enter the flag from the victory screen now to bypass this level.</li></ul></blockquote><h1 id=dynamic-analysis>Dynamic Analysis:</h1><p>When first starting up the application, you are presented with the following screen:</p><p><img src=images/1.PNG alt></p><p>After typing in &ldquo;test&rdquo; as the weapon arming code, a small text message to the right of the TextBox pops up, indicating we&rsquo;ve entered in the wrong code.</p><p>There&rsquo;s not much to it, so let&rsquo;s try to find the code using static analysis.</p><h1 id=static-analysis>Static Analysis:</h1><p>When we load the binary in dnSpy, we see a lot of juicy functions and form controls:</p><p><img src=images/2.PNG alt></p><p>We turn our attention to the FireButton_Click function. Immediately, we find the required code to fire the weapon:</p><p><img src=images/3.PNG alt></p><p>We enter the &ldquo;RAINBOW&rdquo; code into the application and a short animation plays, before advancing onto stage 2.</p><p>We saw the Stage2Form class earlier. Again, we turn to a function called &ldquo;FireButton_Click&rdquo;, which checks if the code we entered matches the return value from a function called &ldquo;isValidWeaponCode&rdquo;. Let&rsquo;s take a look at that function:</p><p><img src=images/4.PNG alt></p><p>We can see it takes our entered code and converts it to a CharArray. It creates a for loop for the duration of our code length. Within the loop it copies our char array into another char array. It takes an index of our loop counter and uses that to access the array and XOR&rsquo;s it with &lsquo;A&rsquo;.</p><p>Our final char array should equal the return value.</p><p>A quick Python script and we should be able to decode this function:</p><pre tabindex=0><code>array = [0x3, &#39; &#39;, &#39;&amp;&#39;, &#39;$&#39;, &#39;-&#39;, 0x1E, 0x2, &#39; &#39;, &#39;/&#39;, &#39;/&#39;, &#39;.&#39;, &#39;/&#39;]
array2 = []

for char in array:
 if type(char) is str:
  result = int(hex(ord(char)), 16) ^ int(hex(ord(&#39;A&#39;)), 16)
 else:
  result = int(hex(char), 16) ^ int(hex(ord(&#39;A&#39;)), 16)
 array2.append(hex(result))
 
print(array2)
</code></pre><p>Entering in the result to a hex to ASCII converter and we get our final answer:</p><p><img src=images/5.PNG alt></p><p>We enter our code into the Stage2Form TextBox and retrieve our flag:</p><p><img src=images/6.PNG alt></p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href=https://isuquo.github.io/>&copy; My blog 2025</a><div><div class=ananke-socials></div></div></div></footer></body></html>