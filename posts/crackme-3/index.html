<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Crackme challenge #3 | My blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Today we&rsquo;ll be looking at a ringzer0 challenge called &ldquo;Crack Me 1&rdquo; made by Mr.Un1k0d3r and can be found here: https://ringzer0ctf.com/challenges/9 - the challenge is worth 3 points.
The goal of the challenge is to find the flag hidden within.
When first executing the executable, we are presented with the following MessageBox:

After pressing OK, the program exits.
Static analysis:
I noticed in PEView that there is a custom resource section, suggesting that their might be hidden data within:"><meta name=generator content="Hugo 0.147.8"><meta name=robots content="index, follow"><link rel=stylesheet href=/ananke/css/main.min.8d048772ae72ab11245a0e296d1f2a36d3e3dd376c6c867394d6cc659c68fc37.css><link rel=canonical href=https://isuquo.github.io/posts/crackme-3/><meta property="og:url" content="https://isuquo.github.io/posts/crackme-3/"><meta property="og:site_name" content="My blog"><meta property="og:title" content="Crackme challenge #3"><meta property="og:description" content="Today we’ll be looking at a ringzer0 challenge called “Crack Me 1” made by Mr.Un1k0d3r and can be found here: https://ringzer0ctf.com/challenges/9 - the challenge is worth 3 points.
The goal of the challenge is to find the flag hidden within.
When first executing the executable, we are presented with the following MessageBox:
After pressing OK, the program exits.
Static analysis: I noticed in PEView that there is a custom resource section, suggesting that their might be hidden data within:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-11-27T00:00:00+00:00"><meta property="article:modified_time" content="2019-11-27T00:00:00+00:00"><meta itemprop=name content="Crackme challenge #3"><meta itemprop=description content="Today we’ll be looking at a ringzer0 challenge called “Crack Me 1” made by Mr.Un1k0d3r and can be found here: https://ringzer0ctf.com/challenges/9 - the challenge is worth 3 points.
The goal of the challenge is to find the flag hidden within.
When first executing the executable, we are presented with the following MessageBox:
After pressing OK, the program exits.
Static analysis: I noticed in PEView that there is a custom resource section, suggesting that their might be hidden data within:"><meta itemprop=datePublished content="2019-11-27T00:00:00+00:00"><meta itemprop=dateModified content="2019-11-27T00:00:00+00:00"><meta itemprop=wordCount content="531"><meta name=twitter:card content="summary"><meta name=twitter:title content="Crackme challenge #3"><meta name=twitter:description content="Today we’ll be looking at a ringzer0 challenge called “Crack Me 1” made by Mr.Un1k0d3r and can be found here: https://ringzer0ctf.com/challenges/9 - the challenge is worth 3 points.
The goal of the challenge is to find the flag hidden within.
When first executing the executable, we are presented with the following MessageBox:
After pressing OK, the program exits.
Static analysis: I noticed in PEView that there is a custom resource section, suggesting that their might be hidden data within:"></head><body class="ma0 avenir bg-near-white production"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l center items-center justify-between"><a href=/ class="f3 fw2 hover-white white-90 dib no-underline">My blog</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l mw8 center ph3 flex-wrap justify-between"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked ttu">Posts</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">Crackme challenge #3</h1><time class="f6 mv4 dib tracked" datetime=2019-11-27T00:00:00Z>November 27, 2019</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>Today we&rsquo;ll be looking at a ringzer0 challenge called &ldquo;Crack Me 1&rdquo; made by Mr.Un1k0d3r and can be found here: <a href=https://ringzer0ctf.com/challenges/9>https://ringzer0ctf.com/challenges/9</a> - the challenge is worth 3 points.</p><p>The goal of the challenge is to find the flag hidden within.</p><p>When first executing the executable, we are presented with the following MessageBox:</p><p><img src=images/1.PNG alt></p><p>After pressing OK, the program exits.</p><h1 id=static-analysis>Static analysis:</h1><p>I noticed in PEView that there is a custom resource section, suggesting that their might be hidden data within:</p><p><img src=images/2.PNG alt></p><p>As I suspected, I was right. We can see the first bytes represent the ASCII value &ldquo;MZ&rdquo;, which is the magic number for an executable. This is also confirmed by the &ldquo;This program cannot be run in DOS mode&rdquo; message. Almost every Windows executable has this message at the beginning of the header.</p><p>If we scroll further down, we can see some interesting text:</p><p><img src=images/3.PNG alt></p><p>So far, we have deduced that there is a resource section hidden within the main PE file that also contains a PE file. We have found that a &ldquo;Secret Message&rdquo; may be hidden within the nested PE file.</p><p>Moving over to IDA, we see the string that is used in the MessageBox when first executing the program. Taking a look at the imports, we see imports such as FindResourceA, LoadResource, MessageBoxA, AddAtomA, FindAtomA, and GetAtomNameA.</p><p>We will focus on the Resource functions for now since we found an embedded exe within the resource section of the file.</p><p>Our next goal is to find out how the resource is being loaded and what it&rsquo;s being loaded into. We might be able to see the flag using some dynamic analysis.</p><p>Let&rsquo;s hop over to Ollydbg.</p><h1 id=dynamic-analysis>Dynamic analysis:</h1><p>Stepping over instructions, we find ourselves in a function that has a peculiar ASCII string. The loop seems to call the &ldquo;rand&rdquo; function and creates a random string. Executing this loop multiple times yields different strings. As you can see below, the string returned for this one was &ldquo;vnasekutos&rdquo;:</p><p><img src=images/4.PNG alt></p><p>Stepping a little further, we can see another string, &ldquo;.dll&rdquo;. Interesting.</p><p><img src=images/5.PNG alt></p><p>After the above function exits, we find ourselves in the function that loads our resource. As you can see below, it is calling LoadResource for the RT_RCDATA section, which matches with what we found using PEView.</p><p><img src=images/6.PNG alt></p><p>After stepping a little more, we can see a call to strcat which concatenates our string we found earlier to another string with the value set as our AppData\Roaming directory.</p><p><img src=images/7.PNG alt></p><p>Finally, we can see a call to CreateFileA and WriteFile. We can now suspect that each time we execute the crack me, it creates a randomly-named dll file in our AppData\Roaming directory, loads the PE file found in the resource section and writes the PE file to our dll file.</p><p>Let&rsquo;s take a look at that dll file.</p><p>As you can see, I have executed the crack me a few times already:</p><p><img src=images/8.PNG alt></p><p>When viewing one of these dll&rsquo;s in IDA, we quickly view the imports window and select the MessageBoxA function. We&rsquo;re taken here:</p><p><img src=images/9.PNG alt></p><p>This is the same &ldquo;Secret Message&rdquo; string we saw earlier when viewing the resource section in PEView.</p><p>Let&rsquo;s see if we can call the DisplayMessage function to display the secret message for us:</p><p><img src=images/10.PNG alt></p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href=https://isuquo.github.io/>&copy; My blog 2025</a><div><div class=ananke-socials></div></div></div></footer></body></html>