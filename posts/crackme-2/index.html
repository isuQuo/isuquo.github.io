<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Crackme challenge #2 | My blog</title><meta name=keywords content><meta name=description content="Today we&rsquo;ll be reversing a crackme by Saduz called &ldquo;Visual c++ crackme&rdquo;, which can be found here: https://crackmes.one/crackme/5c1d6f5f33c5d41e58e005f5
Dynamic analysis:
When executing the crackme, you are presented with a form with two textboxes asking for a Name and Reg num. When clicking the About button, a MessageBox is spawned.

We try &ldquo;test&rdquo; as our Name and &ldquo;123&rdquo; as our Reg num, but a MessageBox is spawned asking us to try again."><meta name=author content="map[hidefooter:true name:Reece Burke]"><link rel=canonical href=https://isuquo.github.io/posts/crackme-2/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://isuquo.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://isuquo.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://isuquo.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://isuquo.github.io/apple-touch-icon.png><link rel=mask-icon href=https://isuquo.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://isuquo.github.io/posts/crackme-2/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://isuquo.github.io/posts/crackme-2/"><meta property="og:site_name" content="My blog"><meta property="og:title" content="Crackme challenge #2"><meta property="og:description" content="Today we’ll be reversing a crackme by Saduz called “Visual c++ crackme”, which can be found here: https://crackmes.one/crackme/5c1d6f5f33c5d41e58e005f5
Dynamic analysis: When executing the crackme, you are presented with a form with two textboxes asking for a Name and Reg num. When clicking the About button, a MessageBox is spawned.
We try “test” as our Name and “123” as our Reg num, but a MessageBox is spawned asking us to try again."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-10-02T00:00:00+00:00"><meta property="article:modified_time" content="2019-10-02T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Crackme challenge #2"><meta name=twitter:description content="Today we&rsquo;ll be reversing a crackme by Saduz called &ldquo;Visual c++ crackme&rdquo;, which can be found here: https://crackmes.one/crackme/5c1d6f5f33c5d41e58e005f5
Dynamic analysis:
When executing the crackme, you are presented with a form with two textboxes asking for a Name and Reg num. When clicking the About button, a MessageBox is spawned.

We try &ldquo;test&rdquo; as our Name and &ldquo;123&rdquo; as our Reg num, but a MessageBox is spawned asking us to try again."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://isuquo.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Crackme challenge #2","item":"https://isuquo.github.io/posts/crackme-2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Crackme challenge #2","name":"Crackme challenge #2","description":"Today we\u0026rsquo;ll be reversing a crackme by Saduz called \u0026ldquo;Visual c++ crackme\u0026rdquo;, which can be found here: https://crackmes.one/crackme/5c1d6f5f33c5d41e58e005f5\nDynamic analysis: When executing the crackme, you are presented with a form with two textboxes asking for a Name and Reg num. When clicking the About button, a MessageBox is spawned.\nWe try \u0026ldquo;test\u0026rdquo; as our Name and \u0026ldquo;123\u0026rdquo; as our Reg num, but a MessageBox is spawned asking us to try again.\n","keywords":[],"articleBody":"Today we’ll be reversing a crackme by Saduz called “Visual c++ crackme”, which can be found here: https://crackmes.one/crackme/5c1d6f5f33c5d41e58e005f5\nDynamic analysis: When executing the crackme, you are presented with a form with two textboxes asking for a Name and Reg num. When clicking the About button, a MessageBox is spawned.\nWe try “test” as our Name and “123” as our Reg num, but a MessageBox is spawned asking us to try again.\nThere’s not much to it, so next, we’ll open the crackme in Ollydbg for further analysis.\nWe know that the crackme spawns a MessageBox with the text “Try again!”, so we could start searching for that. Right click in the CPU window in Olly \u003e Search for \u003e All referenced text strings.\nWe immediately see a “Good work!” string. Double click on that to be taken to the sub routine that most likely handles our input.\nIn order to find out what values need to be written in both of the Name and Reg num textboxes, we will need to find out how it handles our inputs first.\nGenerally in C, we are looking for a couple of methods that handle input from textboxes. Those are GetWindowText() and GetDlgItemText(). If we right click in the CPU window in Olly \u003e Search for \u003e All intermodular calls, and sort by Destination, we can find user32.GetDlgItemText(). Highlight the method and press F2 to set a breakpoint.\nPress play in Olly to resume the crackme. We will enter in our original values of “test” and “123” respectively. After clicking OK, our breakpoint is hit. If we continue to scroll down from our breakpoint, we can see the “Good work!” string again.\nWith this information, it’s good to get a high overview of the sub routine that ensues to find out how our input is handled.\nStatic analysis: If we load the crackme into IDA and search for cross references to our GetDlgItemText() method, we come across the sub routine we were looking at which starts at 0x401080.\nWe can see at 0x4010B3, 0x4010DA and 0x401294 that there are three compares against EAX. One compare leads to the About MessageBoxA we saw, another to a GetUserNameA function and lastly an EndDialog function. These look like our About, OK, and Exit buttons respectively.\nWe obviously want to follow the compare at 0x4010DA.\nIf we decompile this part of the crackme with Ghidra, we can see it calls GetUsernameA and enters a do while loop. The loop exits if the incremental counter is greater than or equal to the length of our username.\nInside the do while loop, we take a byte from our username, an index (nIndex, as shown in the decompilation) and 0x186A0 (100, 000) and add them altogether and assign them back to the index variable. Essentially, we keep adding to the index variable.\nIf our username was “David”, a short python script would look like this:\nusername = \"David\"\resi = 0\rfor i in username:\rnext_byte = int(hex(ord(i)), 16)\resi+=next_byte+0x186A0 Once our do while loop has finished, we head off in the direction to our GetDlgItemText() function call. We can use Ollydbg to run through this function call to find out that it is grabbing the text from the Name textbox, which is “test”.\nGhidra decompilation shows a similar routine as above. This time, it is running through a do while loop and taking each byte of our Name (“test”), the index variable (nIndex) that we were playing with before, and 0x186A0 (100, 000) and adding them altogether again and assigning it back to nIndex.\nThe following Python script can be used to simulate the above routine:\nname = \"test\"\rfor i in name:\rnext_byte = int(hex(ord(i)), 16)\resi+=next_byte+0x186A0 Further decompilation of the subroutine shows another call to wsprintfA and GetDlgItemText(). According to MSDN, wsprintfA is used to write formatted data to a buffer. We can see our input is the nIndex variable + 0x7a69 (31, 337).\nUsing Ollydbg, we can see the next call to GetDlgItemText() gets our Reg num, which we entered as “123”.\nThe above decompilation takes the buffer from wsprintfA and our Reg num (“123”) and essentially compares them together.\nRight, so now that we know enough information to create a keygen, we can write a short Python script to crack the crackme. Here’s the keygen source code:\nusername = input(\"What is your username: \")\rname = input(\"What is your registration name: \")\resi = 0\rfor i in username:\rnext_byte = int(hex(ord(i)), 16)\resi+=next_byte+0x186A0\rfor i in name:\rnext_byte = int(hex(ord(i)), 16)\resi+=next_byte+0x186A0\rreg_num = esi+0x7A69\rprint(reg_num) ","wordCount":"762","inLanguage":"en","datePublished":"2019-10-02T00:00:00Z","dateModified":"2019-10-02T00:00:00Z","author":{"@type":"Person","name":{"hidefooter":true,"name":"Reece Burke"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://isuquo.github.io/posts/crackme-2/"},"publisher":{"@type":"Organization","name":"My blog","logo":{"@type":"ImageObject","url":"https://isuquo.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://isuquo.github.io/ accesskey=h title="My blog (Alt + H)">My blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Crackme challenge #2</h1><div class=post-meta><span title='2019-10-02 00:00:00 +0000 UTC'>October 2, 2019</span>&nbsp;·&nbsp;map[hidefooter:true name:Reece Burke]</div></header><div class=post-content><p>Today we&rsquo;ll be reversing a crackme by Saduz called &ldquo;Visual c++ crackme&rdquo;, which can be found here: <a href=https://crackmes.one/crackme/5c1d6f5f33c5d41e58e005f5>https://crackmes.one/crackme/5c1d6f5f33c5d41e58e005f5</a></p><h1 id=dynamic-analysis>Dynamic analysis:<a hidden class=anchor aria-hidden=true href=#dynamic-analysis>#</a></h1><p>When executing the crackme, you are presented with a form with two textboxes asking for a Name and Reg num. When clicking the About button, a MessageBox is spawned.</p><p><img loading=lazy src=/posts/crackme-2/images/1.PNG></p><p>We try &ldquo;test&rdquo; as our Name and &ldquo;123&rdquo; as our Reg num, but a MessageBox is spawned asking us to try again.</p><p><img loading=lazy src=/posts/crackme-2/images/2.PNG></p><p>There&rsquo;s not much to it, so next, we&rsquo;ll open the crackme in Ollydbg for further analysis.</p><p>We know that the crackme spawns a MessageBox with the text &ldquo;Try again!&rdquo;, so we could start searching for that. Right click in the CPU window in Olly > Search for > All referenced text strings.</p><p>We immediately see a &ldquo;Good work!&rdquo; string. Double click on that to be taken to the sub routine that most likely handles our input.</p><p>In order to find out what values need to be written in both of the Name and Reg num textboxes, we will need to find out how it handles our inputs first.</p><p>Generally in C, we are looking for a couple of methods that handle input from textboxes. Those are GetWindowText() and GetDlgItemText(). If we right click in the CPU window in Olly > Search for > All intermodular calls, and sort by Destination, we can find user32.GetDlgItemText(). Highlight the method and press F2 to set a breakpoint.</p><p>Press play in Olly to resume the crackme. We will enter in our original values of &ldquo;test&rdquo; and &ldquo;123&rdquo; respectively. After clicking OK, our breakpoint is hit. If we continue to scroll down from our breakpoint, we can see the &ldquo;Good work!&rdquo; string again.</p><p>With this information, it&rsquo;s good to get a high overview of the sub routine that ensues to find out how our input is handled.</p><h1 id=static-analysis>Static analysis:<a hidden class=anchor aria-hidden=true href=#static-analysis>#</a></h1><p>If we load the crackme into IDA and search for cross references to our GetDlgItemText() method, we come across the sub routine we were looking at which starts at 0x401080.</p><p>We can see at 0x4010B3, 0x4010DA and 0x401294 that there are three compares against EAX. One compare leads to the About MessageBoxA we saw, another to a GetUserNameA function and lastly an EndDialog function. These look like our About, OK, and Exit buttons respectively.</p><p>We obviously want to follow the compare at 0x4010DA.</p><p>If we decompile this part of the crackme with Ghidra, we can see it calls GetUsernameA and enters a do while loop. The loop exits if the incremental counter is greater than or equal to the length of our username.</p><p><img loading=lazy src=/posts/crackme-2/images/3.PNG></p><p>Inside the do while loop, we take a byte from our username, an index (nIndex, as shown in the decompilation) and 0x186A0 (100, 000) and add them altogether and assign them back to the index variable. Essentially, we keep adding to the index variable.</p><p>If our username was &ldquo;David&rdquo;, a short python script would look like this:</p><pre tabindex=0><code>username = &#34;David&#34;

esi = 0
for i in username:
  next_byte = int(hex(ord(i)), 16)
  esi+=next_byte+0x186A0
</code></pre><p>Once our do while loop has finished, we head off in the direction to our GetDlgItemText() function call. We can use Ollydbg to run through this function call to find out that it is grabbing the text from the Name textbox, which is &ldquo;test&rdquo;.</p><p>Ghidra decompilation shows a similar routine as above. This time, it is running through a do while loop and taking each byte of our Name (&ldquo;test&rdquo;), the index variable (nIndex) that we were playing with before, and 0x186A0 (100, 000) and adding them altogether again and assigning it back to nIndex.</p><p><img loading=lazy src=/posts/crackme-2/images/4.PNG></p><p>The following Python script can be used to simulate the above routine:</p><pre tabindex=0><code>name = &#34;test&#34;

for i in name:
  next_byte = int(hex(ord(i)), 16)
  esi+=next_byte+0x186A0
</code></pre><p>Further decompilation of the subroutine shows another call to wsprintfA and GetDlgItemText(). According to MSDN, wsprintfA is used to write formatted data to a buffer. We can see our input is the nIndex variable + 0x7a69 (31, 337).</p><p>Using Ollydbg, we can see the next call to GetDlgItemText() gets our Reg num, which we entered as &ldquo;123&rdquo;.</p><p><img loading=lazy src=/posts/crackme-2/images/5.PNG></p><p>The above decompilation takes the buffer from wsprintfA and our Reg num (&ldquo;123&rdquo;) and essentially compares them together.</p><p>Right, so now that we know enough information to create a keygen, we can write a short Python script to crack the crackme. Here&rsquo;s the keygen source code:</p><pre tabindex=0><code>username = input(&#34;What is your username: &#34;)
name = input(&#34;What is your registration name: &#34;)

esi = 0
for i in username:
    next_byte = int(hex(ord(i)), 16)
    esi+=next_byte+0x186A0
 
for i in name:
    next_byte = int(hex(ord(i)), 16)
    esi+=next_byte+0x186A0
 
reg_num = esi+0x7A69
print(reg_num)
</code></pre><p><img loading=lazy src=/posts/crackme-2/images/6.PNG></p><p><img loading=lazy src=/posts/crackme-2/images/7.PNG></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://isuquo.github.io/>My blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>