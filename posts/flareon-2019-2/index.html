<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Flare-on 2019 challenge #2 | My blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Welcome to the second Flare-on 2019 write up. For this one, we&rsquo;ll be looking at an application called &ldquo;Overlong&rdquo;, which is also the name of the challenge.
The readme that comes with the challenge reads:

The secret of this next challenge is cleverly hidden. However, with the right approach, finding the solution will not take an overlong amount of time.
Dynamic Analysis:
There isn&rsquo;t much to the application. When executing a MessageBox shows the following:"><meta name=generator content="Hugo 0.147.8"><meta name=robots content="index, follow"><link rel=stylesheet href=/ananke/css/main.min.8d048772ae72ab11245a0e296d1f2a36d3e3dd376c6c867394d6cc659c68fc37.css><link rel=canonical href=https://isuquo.github.io/posts/flareon-2019-2/><meta property="og:url" content="https://isuquo.github.io/posts/flareon-2019-2/"><meta property="og:site_name" content="My blog"><meta property="og:title" content="Flare-on 2019 challenge #2"><meta property="og:description" content="Welcome to the second Flare-on 2019 write up. For this one, we’ll be looking at an application called “Overlong”, which is also the name of the challenge.
The readme that comes with the challenge reads:
The secret of this next challenge is cleverly hidden. However, with the right approach, finding the solution will not take an overlong amount of time.
Dynamic Analysis: There isn’t much to the application. When executing a MessageBox shows the following:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-10-06T00:00:00+00:00"><meta property="article:modified_time" content="2019-10-06T00:00:00+00:00"><meta itemprop=name content="Flare-on 2019 challenge #2"><meta itemprop=description content="Welcome to the second Flare-on 2019 write up. For this one, we’ll be looking at an application called “Overlong”, which is also the name of the challenge.
The readme that comes with the challenge reads:
The secret of this next challenge is cleverly hidden. However, with the right approach, finding the solution will not take an overlong amount of time.
Dynamic Analysis: There isn’t much to the application. When executing a MessageBox shows the following:"><meta itemprop=datePublished content="2019-10-06T00:00:00+00:00"><meta itemprop=dateModified content="2019-10-06T00:00:00+00:00"><meta itemprop=wordCount content="378"><meta name=twitter:card content="summary"><meta name=twitter:title content="Flare-on 2019 challenge #2"><meta name=twitter:description content="Welcome to the second Flare-on 2019 write up. For this one, we’ll be looking at an application called “Overlong”, which is also the name of the challenge.
The readme that comes with the challenge reads:
The secret of this next challenge is cleverly hidden. However, with the right approach, finding the solution will not take an overlong amount of time.
Dynamic Analysis: There isn’t much to the application. When executing a MessageBox shows the following:"></head><body class="ma0 avenir bg-near-white production"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l center items-center justify-between"><a href=/ class="f3 fw2 hover-white white-90 dib no-underline">My blog</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l mw8 center ph3 flex-wrap justify-between"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked ttu">Posts</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">Flare-on 2019 challenge #2</h1><time class="f6 mv4 dib tracked" datetime=2019-10-06T00:00:00Z>October 6, 2019</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>Welcome to the second Flare-on 2019 write up. For this one, we&rsquo;ll be looking at an application called &ldquo;Overlong&rdquo;, which is also the name of the challenge.</p><p>The readme that comes with the challenge reads:</p><blockquote><p>The secret of this next challenge is cleverly hidden. However, with the right approach, finding the solution will not take an overlong amount of time.</p></blockquote><h1 id=dynamic-analysis>Dynamic Analysis:</h1><p>There isn&rsquo;t much to the application. When executing a MessageBox shows the following:</p><p><img src=images/1.PNG alt></p><p>We load the executable into Ollydbg and we start debugging. it is relatively easy to find the decoding function. Within a few steps, we come to a call to the sub routine at address 0x401160. Stepping over the call and over the next instruction shows us that the string &ldquo;I never broke the encoding:&rdquo; is placed into the ESP register.</p><p>We can now deduce that the function called beforehand is the function we need to be looking at.</p><p>Stepping through this function slowly, we come across another call to 0x401000. This function seems like the real decoding function. A few instructions after the call to 0x401000, I noticed the address of the ASCII character &ldquo;I&rdquo; is being moved into EDX:</p><p><img src=images/2.PNG alt></p><p>After the execution of this instruction, we right click on the ECX register and follow the address in the memory dump. As we set a breakpoint at this instruction and run through the application, we begin to see our string being decoded in the dump:</p><p><img src=images/3.PNG alt></p><p>After decoding the &ldquo;:&rdquo; character, the loop exits and spawns our MessageBox with the decoded text.</p><p>Initially I thought because of the &ldquo;:&rdquo; character, there must be more to decode. I restart the application and play through the loop again until I find the instruction that exits us out of the loop.</p><p>We come here:</p><p><img src=images/4.PNG alt></p><p>We can see EAX is served as a counter. The length of the MessageBox text is 0x1c long. Coincidentally, the CMP instruction is looking for this value. If the value is not below 0x1c, it continues the loop. However, our EAX counter is 0x1c long, so the loop exits.</p><p>What happens if we NOP this instruction?</p><p><img src=images/5.PNG alt></p><p>Bingo! We have retrieved the flag by patching the instruction that exits us out of the loop, which enables us to decode the rest of the text.</p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href=https://isuquo.github.io/>&copy; My blog 2025</a><div><div class=ananke-socials></div></div></div></footer></body></html>